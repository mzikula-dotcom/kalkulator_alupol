LIST 1 zadání VBA

'vycisteni nezadanych hodnotPrivate Sub Vymaz_prazdne()  'plný poly v modulech  If Not (CheckBox3.Value) Then    List1.Cells(17, 2).Value = ""  End If  'změna barvy v modulech  If Not (CheckBox6.Value) Then    List1.Cells(20, 2).Value = ""    List1.Cells(20, 3).Value = ""  End If  'změna barvy VČ  If Not (CheckBox7.Value) Then    List1.Cells(21, 2).Value = ""  End If  'změna barvy MČ  If Not (CheckBox8.Value) Then    List1.Cells(22, 2).Value = ""  End If  'pochozí koleje  If Not (CheckBox30.Value) Then    List1.Cells(46, 2).Value = ""  End If  'obousměrné koleje  If Not (CheckBox9.Value) Then    List1.Cells(26, 2).Value = ""  End If  'prodloužení kolejí  If Not (CheckBox10.Value) Then    List1.Cells(27, 2).Value = ""  End If  'VČ dveře  If Not (OptionButton3.Value) Then    List1.Cells(30, 2).Value = ""    List1.Cells(31, 2).Value = ""    List1.Cells(31, 3).Value = ""  End If  'VČ klapka  If Not (OptionButton4.Value) Then    List1.Cells(32, 2).Value = ""  End If  'VČzámek  If Not (CheckBox25.Value) Then    List1.Cells(33, 2).Value = ""  End If    'zámek není pokud je čelo pevné  If (OptionButton1.Value) Then    List1.Cells(33, 2).Value = ""  End If  'MČ dveře  If Not (OptionButton7.Value) Then    List1.Cells(36, 2).Value = ""    List1.Cells(37, 2).Value = ""    List1.Cells(37, 3).Value = ""  End If  'MČ klapka  If Not (OptionButton8.Value) Then    List1.Cells(38, 2).Value = ""  End If  'MČzámek  If Not (CheckBox26.Value) Then    List1.Cells(39, 2).Value = ""  End If  'zámek není pokud je čelo pevné  If (OptionButton5.Value) Then    List1.Cells(39, 2).Value = ""  End If     'BD  If Not (CheckBox12.Value) Then    List1.Cells(40, 2).Value = ""    List1.Cells(41, 2).Value = ""  End If   'BD  If Not (CheckBox13.Value) Then    List1.Cells(41, 2).Value = ""  End If     'Jiny doplnek 1  If Not (CheckBox16.Value) Then    List1.Cells(43, 2).Value = ""    List1.Cells(43, 3).Value = ""  End If   'Jiny doplnek 2  If Not (CheckBox17.Value) Then    List1.Cells(44, 2).Value = ""    List1.Cells(44, 3).Value = ""  End If   'Jiny doplnek 3  If Not (CheckBox18.Value) Then    List1.Cells(45, 2).Value = ""    List1.Cells(45, 3).Value = ""  End IfEnd Sub'Změna typu zastřešeníPrivate Sub ComboBox2_afterupdate()  Zmena_hodnot  If ComboBox2.Value = "PRACTIC" Then  List7.ImageNabidka.Picture = List2.ImagePractic.Picture  CheckBox32.Visible = True  CheckBox33.Visible = False  End If  If ComboBox2.Value = "HARMONY" Then   List7.ImageNabidka.Picture = List2.ImageHarmony.Picture   CheckBox32.Visible = True   CheckBox33.Visible = True  End If  If ComboBox2.Value = "DREAM" Then   List7.ImageNabidka.Picture = List2.ImageDream.Picture   CheckBox32.Visible = True   CheckBox33.Visible = True  End If  If ComboBox2.Value = "HORIZONT" Then    List7.ImageNabidka.Picture = List2.ImageHorizont.Picture    CheckBox32.Visible = True    CheckBox33.Visible = False  End If  If ComboBox2.Value = "STAR" Then   List7.ImageNabidka.Picture = List2.ImageStar.Picture   CheckBox32.Visible = True   CheckBox33.Visible = True  End If  If ComboBox2.Value = "ROCK" Then   List7.ImageNabidka.Picture = List2.ImageRock.Picture   CheckBox32.Visible = True   CheckBox33.Visible = False  End If  If ComboBox2.Value = "TERRACE" Then   List7.ImageNabidka.Picture = List2.ImageTerrace.Picture   CheckBox32.Visible = True   CheckBox33.Visible = True  End If  If ComboBox2.Value = "WAVE" Then   List7.ImageNabidka.Picture = List2.ImageWave.Picture   CheckBox32.Visible = True   CheckBox33.Visible = False  End If   If ComboBox2.Value = "FLASH" Then   List7.ImageNabidka.Picture = List2.ImageFlash.Picture   CheckBox32.Visible = True   CheckBox33.Visible = False  End If   If ComboBox2.Value = "WING" Then   List7.ImageNabidka.Picture = List2.ImageWing.Picture   CheckBox32.Visible = True   CheckBox33.Visible = False  End If     If ComboBox2.Value = "SUNSET" Then    List7.ImageNabidka.Picture = List2.ImageSunset.Picture    CheckBox32.Visible = True    CheckBox33.Visible = False  End IfEnd Sub'Zmena počtu modulůPrivate Sub ComboBox3_AfterUpdate()  Zmena_hodnotEnd Sub'HotovoPrivate Sub CommandButton1_Click()  Module1.Vymaz_nabidku  Vymaz_prazdne  radek = 23  'Změna výšky  If List1.Cells(16, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Zvýšení zastřešení o"    List7.Cells(radek, 4).Value = CStr(CLng(List1.Cells(14, 2).Value) - CLng(List1.Cells(14, 3).Value))    List7.Cells(radek, 5).Value = "mm"    List7.Cells(radek, 6).Value = List1.Cells(16, 4).Value    radek = radek + 1  End If    If List1.Cells(14, 4).Value < 0 Then    List7.Cells(radek, 1).Value = "Snížení zastřešení o"    List7.Cells(radek, 4).Value = CStr((CLng(List1.Cells(14, 2).Value) - CLng(List1.Cells(14, 3).Value)) * -1)    List7.Cells(radek, 5).Value = "mm"    List7.Cells(radek, 6).Value = "ZDARMA"    radek = radek + 1  End If      'Plný poly v modulech If List1.Cells(17, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Plný polykarbonát v "    List7.Cells(radek, 4).Value = (List1.Cells(17, 2).Value)    List7.Cells(radek, 5).Value = "modulech"    List7.Cells(radek, 6).Value = List1.Cells(17, 4).Value    radek = radek + 1  End If  'Plný poly ve VČ  If List1.Cells(18, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Plný polykarbonát ve velkém čele "    List7.Cells(radek, 6).Value = List1.Cells(18, 4).Value    radek = radek + 1  End If  'Plný poly ve MČ  If List1.Cells(19, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Plný polykarbonát v malém čele "    List7.Cells(radek, 6).Value = List1.Cells(19, 4).Value    radek = radek + 1  End If  'plný poly v šikminách  If List1.Cells(29, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Plný polykarbonát v šikminách "    List7.Cells(radek, 6).Value = List1.Cells(29, 4).Value    radek = radek + 1  End If    'Barevný poly v modulech  If List1.Cells(20, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Změna barvy výplně na " + ComboBox5.Value + " v"    List7.Cells(radek, 4).Value = (List1.Cells(20, 3).Value)    List7.Cells(radek, 5).Value = "modulech"    List7.Cells(radek, 6).Value = List1.Cells(20, 4).Value    radek = radek + 1  End If  'Barevný poly ve VČ  If List1.Cells(21, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Změna barvy výplně na " + ComboBox7.Value + " ve velkém čele"    List7.Cells(radek, 6).Value = List1.Cells(21, 4).Value    radek = radek + 1  End If  'Barevný poly ve MČ  If List1.Cells(22, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Změna barvy výplně na " + ComboBox8.Value + " v malém čele"    List7.Cells(radek, 6).Value = List1.Cells(22, 4).Value    radek = radek + 1  End If  'Zpevnění pro podh oblast  If List1.Cells(23, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Zpevnění pro podhorskou oblast"    List7.Cells(radek, 6).Value = List1.Cells(23, 4).Value    radek = radek + 1  End If  'Prodloužení zastřešení  If List1.Cells(24, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Prodloužení " + ComboBox14.Value + " modulů o"    List7.Cells(radek, 4).Value = CStr(CLng(List1.Cells(13, 2).Value) - CLng(List1.Cells(13, 3).Value))    List7.Cells(radek, 5).Value = "mm"    List7.Cells(radek, 6).Value = List1.Cells(24, 4).Value    radek = radek + 1  End If   'Zkrácení zastřešení  If List1.Cells(25, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Zkrácení " + ComboBox14.Value + " modulů o " + CStr(CLng(List1.Cells(13, 4).Value)) + " mm"    List7.Cells(radek, 6).Value = List1.Cells(25, 4).Value    radek = radek + 1  End If  'Pochozí koleje  If List1.Cells(46, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Pochozí koleje"   ' List7.Cells(radek, 6).Value = List1.Cells(46, 4).Value    List7.Cells(radek, 6).Value = "ZDARMA"    radek = radek + 1  End If    'Obousměrné koleje  If List1.Cells(26, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Obousměrné koleje"   ' List7.Cells(radek, 6).Value = List1.Cells(26, 4).Value    List7.Cells(radek, 6).Value = "ZDARMA"    radek = radek + 1  End If  'Prodloužení kolejí If List1.Cells(27, 2).Value > 0 Then    List7.Cells(radek, 1).Value = "Prodloužení kolejí o"    List7.Cells(radek, 4).Value = List1.Cells(27, 2).Value    List7.Cells(radek, 5).Value = "mm"    If List1.Cells(27, 4).Value = 0 Then       List7.Cells(radek, 6).Value = "ZDARMA"    Else      List7.Cells(radek, 6).Value = List1.Cells(27, 4).Value    End If    radek = radek + 1  End If  'Bez velkého čela  If List1.Cells(28, 4).Value < 0 Then    List7.Cells(radek, 1).Value = "Bez velkého čela"    List7.Cells(radek, 6).Value = List1.Cells(28, 4).Value    radek = radek + 1  End If    'VČ dveře  If List1.Cells(30, 4).Value > 0 Then    List7.Cells(radek, 1).Value = ComboBox16.Value + " dveře ve velkém čele š=" + TextBox9.Value + "  v=" + TextBox10.Value + " mm (výška je přibližná)"    List7.Cells(radek, 6).Value = List1.Cells(30, 4).Value    radek = radek + 1  End If  'VČ klapka  If List1.Cells(32, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Větrací klapka ve velkém čele vysoká " + TextBox11.Value + " mm "    List7.Cells(radek, 6).Value = List1.Cells(32, 4).Value    radek = radek + 1  End If  'VČ zámek  If List1.Cells(33, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Uzamykání dveří "    List7.Cells(radek, 6).Value = List1.Cells(33, 4).Value    radek = radek + 1  End If  'Bez malého čela  If List1.Cells(34, 4).Value < 0 Then    List7.Cells(radek, 1).Value = "Bez malého čela"    List7.Cells(radek, 6).Value = List1.Cells(34, 4).Value    radek = radek + 1  End If  'MČ dělené na části  If List1.Cells(35, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Malé čelo dělené na " + TextBox12.Value + " kusy"    List7.Cells(radek, 6).Value = List1.Cells(35, 4).Value    radek = radek + 1  End If  'MČ dveře  If List1.Cells(36, 4).Value > 0 Then    List7.Cells(radek, 1).Value = ComboBox17.Value + " dveře v malém čele š=" + TextBox13.Value + " v=" + TextBox14.Value + " mm (výška je přibližná)"    List7.Cells(radek, 6).Value = List1.Cells(36, 4).Value    radek = radek + 1  End If  'MČ klapka  If List1.Cells(38, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Větrací klapka v malém čele vysoká " + TextBox15.Value + " mm "    List7.Cells(radek, 6).Value = List1.Cells(38, 4).Value    radek = radek + 1  End If  'MČ zámek  If List1.Cells(39, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Uzamykání dveří "    List7.Cells(radek, 6).Value = List1.Cells(39, 4).Value    radek = radek + 1  End If  'BD  If List1.Cells(40, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Dveře pro boční vstup "    List7.Cells(radek, 6).Value = List1.Cells(40, 4).Value    radek = radek + 1  End If  'BD zámek  If List1.Cells(41, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Uzamykání dveří "    List7.Cells(radek, 6).Value = List1.Cells(41, 4).Value    radek = radek + 1  End If  'Uzamykání segmentů  If List1.Cells(42, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Uzamykání " + CStr(List1.Cells(12, 2).Value - 1) + " segmentů"    List7.Cells(radek, 6).Value = List1.Cells(42, 4).Value    radek = radek + 1  End If    'Změna barvy konstrukce  If List1.Cells(47, 4).Value <> 0 Then    List7.Cells(radek, 1).Value = "Nástřik konstrukce dle RAL - " + CStr(List1.Cells(47, 3).Value)    List7.Cells(radek, 6).Value = List1.Cells(47, 4).Value    radek = radek + 1  End If    'Bronzový elox  If List1.Cells(48, 2).Value = "Bronz" Then    List7.Cells(radek, 1).Value = "Konstrukce v bronzovém eloxu"    List7.Cells(radek, 6).Value = List1.Cells(48, 4).Value    radek = radek + 1  End If    'Antracitový elox  If List1.Cells(48, 2).Value = "Antracit" Then    List7.Cells(radek, 1).Value = "Konstrukce v antracitovém eloxu"    List7.Cells(radek, 6).Value = List1.Cells(48, 4).Value    radek = radek + 1  End If    'Jiný příplatek 1  If List1.Cells(43, 4).Value <> 0 Then    List7.Cells(radek, 1).Value = List1.Cells(43, 2).Value    List7.Cells(radek, 6).Value = List1.Cells(43, 4).Value    radek = radek + 1  End If  'Jiný příplatek 2  If List1.Cells(44, 4).Value <> 0 Then    List7.Cells(radek, 1).Value = List1.Cells(44, 2).Value    List7.Cells(radek, 6).Value = List1.Cells(44, 4).Value    radek = radek + 1  End If  'Jiný příplatek 3  If List1.Cells(45, 4).Value <> 0 Then    List7.Cells(radek, 1).Value = List1.Cells(45, 2).Value    List7.Cells(radek, 6).Value = List1.Cells(45, 4).Value    radek = radek + 1  End If        'Akce na stříbrný elox  If List7.Cells(19, 4).Value = "stříbrný elox" Then    List7.Cells(radek, 1).Value = "Sleva na stříbrný elox"    List7.Cells(radek, 6).Value = List7.Cells(22, 6).Value / 10 * -1    radek = radek + 1  End If      radek = radek + 1     'Cena zastřešení  List7.Cells(radek, 1).Value = "Cena zastřešení"  List7.Cells(radek, 6).Formula = "=SUM(F21:F" + CStr(radek - 1) + ")"  cena_zastreseni = CLng(List7.Cells(radek, 6).Value)  radek_ceny = radek  radek = radek + 2  'Doprava  If CheckBox19.Value Then    If TextBox22.Value = "" Then      radek = radek + 1    ElseIf CLng(TextBox22.Value) > 0 Then      List7.Cells(radek, 1).Value = "Doprava"      List7.Cells(radek, 4).Value = TextBox22.Value      List7.Cells(radek, 5).Value = "km"      cena_dopravy = CLng(CDec((TextBox22.Value) * CDec(TextBox23.Value)))      List7.Cells(radek, 6).Value = CStr(cena_dopravy)      radek_dopravy = radek      radek = radek + 1    ElseIf CLng(TextBox22.Value) = 0 Then        List7.Cells(radek, 1).Value = "Doprava"        List7.Cells(radek, 6).Value = "ZDARMA"        cena_dopravy = 0        radek_dopravy = radek        radek = radek + 1    End If  Else    List7.Cells(radek, 1).Value = "Doprava"    List7.Cells(radek, 6).Value = "VLASTNÍ"    cena_dopravy = 0    radek = radek + 1  End If  'Montáž  If ComboBox13.Value <> "" Then    If ComboBox13.Value = "ZDARMA" Then      List7.Cells(radek, 1).Value = "Montáž"      List7.Cells(radek, 6).Value = ComboBox13.Value      cena_montaze = 0      radek = radek + 1    ElseIf ComboBox13.Value = "Montáž v CZ" Then       List7.Cells(radek, 1).Value = ComboBox13.Value       cena_montaze = CDec(List1.Cells(52, 4).Value)       List7.Cells(radek, 6) = cena_montaze       radek = radek + 1        ElseIf ComboBox13.Value = "Montáž v EU" Then       List7.Cells(radek, 1).Value = ComboBox13.Value        cena_montaze = CDec(List1.Cells(52, 4).Value)       List7.Cells(radek, 6) = cena_montaze       radek = radek + 1        ElseIf ComboBox13.Value = "Vlastní" Then       List7.Cells(radek, 1).Value = "Montáž"       List7.Cells(radek, 6).Value = ComboBox13.Value       cena_montaze = 0       radek = radek + 1    End If  Else    radek = radek + 1  End If  radek = radek + 1    'Celkova cena odběratel     List7.Cells(radek, 1).Value = "Celková cena zastřešení"     celkova_cena_zastreseni = CStr(CLng(cena_zastreseni + cena_montaze + cena_dopravy))     List7.Cells(radek, 6).Value = celkova_cena_zastreseni     List7.Cells(radek, 7).Value = " + DPH"     radek_celk_ceny = radek     radek = radek + 2     If CheckBox20.Value Then       List7.Cells(radek, 1).Value = "Sleva pro Vás"       List7.Cells(radek, 4).Value = TextBox24.Value       List7.Cells(radek, 5).Value = "%"       sleva = CStr(CLng(cena_zastreseni * CDbl(TextBox24.Value) / 100))       List7.Cells(radek, 6).Value = sleva       List7.Cells(radek, 7).Value = " + DPH"       radek = radek + 1       List7.Cells(radek, 1).Value = "Cena pro Vás"       List7.Cells(radek, 6).Value = CStr(CLng(celkova_cena_zastreseni) - CLng(sleva))       List7.Cells(radek, 6).Font.Size = 13       List7.Cells(radek, 6).Font.Underline = xlUnderlineStyleSingle       List7.Cells(radek, 7).Value = " + DPH"       radek = radek + 2     End If     If CheckBox22.Value Then       List7.Cells(radek, 1).Value = TextBox25.Value       List7.Cells(radek, 4).Value = TextBox26.Value       List7.Cells(radek, 5).Value = "%"       sleva = CStr(CLng(cena_zastreseni * CDbl(TextBox26.Value) / 100))       List7.Cells(radek, 6).Value = sleva       List7.Cells(radek, 7).Value = " + DPH"       radek = radek + 1       List7.Cells(radek, 1).Value = "Cena pro Vás"       List7.Cells(radek, 6).Value = CStr(CLng(celkova_cena_zastreseni) - CLng(sleva))       List7.Cells(radek, 6).Font.Size = 15       List7.Cells(radek, 6).Font.Underline = xlUnderlineStyleSingle       List7.Cells(radek, 7).Value = " + DPH"       radek = radek + 3     End If  'platnost nabídky  List7.Cells(radek, 1).Value = "Platnost nabídky " + TextBox3.Value + " měsíce od vypracování."  radek = radek + 2  'vypracoval  List7.Cells(radek, 1).Value = "Vypracoval:  " + TextBox32.Text + "  mob.: " + TextBox29.Text  FormZadani.Hide  List7.Activate    End Sub'Tlačítko konecPrivate Sub CommandButton2_Click()  FormZadani.HideEnd Sub'Vymaze hodnotyPrivate Sub CommandButton3_Click()Vymyz_hodnotyEnd Sub'Standartní šířkaPrivate Sub CheckBox1_Change()  If CheckBox1.Value Then Zmena_hodnot  TextBox5.Enabled = Not (CheckBox1.Value)  Label32.Visible = Not (CheckBox1.Value)  ComboBox14.Visible = Not (CheckBox1.Value)  End Sub'Prodloužení kolejíPrivate Sub CheckBox10_Change()  TextBox7.Visible = CheckBox10.Value    If TextBox7.Value <> "" Then      List1.Cells(27, 2) = CLng(TextBox7.Value)    Else      List1.Cells(27, 2) = 0    End IfEnd Sub'Zpevnění pro podhorskou oblastPrivate Sub CheckBox11_Change()  If CheckBox11.Value Then    List1.Cells(23, 2) = "Ano"  Else    List1.Cells(23, 2) = ""  End IfEnd Sub'BDPrivate Sub CheckBox12_Change()  If CheckBox12.Value Then    List1.Cells(40, 2) = "Ano"  Else    List1.Cells(40, 2) = ""  End IfEnd Sub'Zámek BDPrivate Sub CheckBox13_Change()  If CheckBox13.Value Then    List1.Cells(41, 2) = "Ano"  Else    List1.Cells(41, 2) = ""  End IfEnd Sub'barva konstrukcePrivate Sub CheckBox31_Change()  TextBox30.Visible = CheckBox31.Value    If CheckBox31.Value = True Then      List1.Cells(47, 2) = "Ano"      List1.Cells(47, 3) = TextBox30.Value    Else      List1.Cells(47, 2) = ""      List1.Cells(47, 3) = ""    End IfEnd Sub'Jiný příplatek 1Private Sub CheckBox16_Change()  TextBox16.Visible = CheckBox16.Value  TextBox17.Visible = CheckBox16.Value  Label22.Visible = CheckBox16.ValueEnd Sub'Jiný příplatek 2Private Sub CheckBox17_Change()  TextBox18.Visible = CheckBox17.Value  TextBox19.Visible = CheckBox17.Value  Label23.Visible = CheckBox17.ValueEnd Sub'Jiný příplatek 3Private Sub CheckBox18_Change()  TextBox20.Visible = CheckBox18.Value  TextBox21.Visible = CheckBox18.Value  Label24.Visible = CheckBox18.ValueEnd Sub'DopravaPrivate Sub CheckBox19_Change()  TextBox22.Visible = CheckBox19.Value  TextBox23.Visible = CheckBox19.Value  Label25.Visible = CheckBox19.Value  Label26.Visible = CheckBox19.ValueEnd Sub'Standartní výškaPrivate Sub CheckBox2_Change()TextBox6.Enabled = Not (CheckBox2.Value)If CheckBox2.Value Then Zmena_hodnotEnd Sub'Viditelnos velké čeloPrivate Sub CheckBox14_Change()  Frame3.Visible = CheckBox14.Value  If Not (CheckBox14.Value) Then    List1.Cells(28, 2) = "Ano"  Else    List1.Cells(28, 2) = ""  End IfEnd Sub'Viditelnos malé čeloPrivate Sub CheckBox15_Change()  Frame4.Visible = CheckBox15.Value  If Not (CheckBox15.Value) Then    List1.Cells(34, 2) = "Ano"  Else    List1.Cells(34, 2) = ""  End IfEnd Sub'Odběratel standartní peovizePrivate Sub CheckBox20_Change()  TextBox24.Visible = CheckBox20.Value  Label28.Visible = CheckBox20.ValueEnd Sub'Odběratel zvláštní provizePrivate Sub CheckBox22_Change()  TextBox25.Visible = CheckBox22.Value  TextBox26.Visible = CheckBox22.Value  Label29.Visible = CheckBox22.ValueEnd Sub'Zákazník zvláštní provizePrivate Sub CheckBox24_Change()  TextBox27.Visible = CheckBox24.Value  TextBox28.Visible = CheckBox24.Value  Label30.Visible = CheckBox24.ValueEnd Sub'VČ zámek dveříPrivate Sub CheckBox25_Change()  If CheckBox25.Value Then    List1.Cells(33, 2) = "Ano"  Else    List1.Cells(33, 2) = ""  End IfEnd Sub'MČ zámek dveříPrivate Sub CheckBox26_Change()  If CheckBox26.Value Then    List1.Cells(39, 2) = "Ano"  Else    List1.Cells(39, 2) = ""  End IfEnd Sub'Uzamykání segmentůPrivate Sub CheckBox29_Change()  If CheckBox29.Value Then    List1.Cells(42, 2) = "Ano"  Else    List1.Cells(42, 2) = ""  End IfEnd Sub'Plný poly v modulechPrivate Sub CheckBox3_Change()  ComboBox4.Visible = CheckBox3.Value  Label9.Visible = CheckBox3.Value  If CheckBox3.Value Then    List1.Cells(17, 2) = ComboBox4.Value    List1.Cells(17, 3) = "Poly"  End IfEnd Sub'Bronzový eloxPrivate Sub CheckBox32_Click()If CheckBox32.Value Then    List1.Cells(48, 2) = "Bronz"  Else    List1.Cells(48, 2) = ""  End IfEnd Sub'Plný poly v šikmináchPrivate Sub CheckBox33_Click()  If CheckBox33.Value Then    List1.Cells(29, 2) = "Ano"    List1.Cells(29, 3) = "Poly"  Else    List1.Cells(29, 2) = ""  End IfEnd Sub'Antracitový eloxPrivate Sub CheckBox34_Click()If CheckBox34.Value Then    List1.Cells(48, 2) = "Antracit"  Else    List1.Cells(48, 2) = ""  End IfEnd Sub'Plný poly ve VČPrivate Sub CheckBox4_Change()  If CheckBox4.Value Then    List1.Cells(18, 2) = "Ano"    List1.Cells(18, 3) = "Poly"  Else    List1.Cells(18, 2) = ""  End IfEnd Sub'Plný poly v MČPrivate Sub CheckBox5_Change()  If CheckBox5.Value Then    List1.Cells(19, 2) = "Ano"    List1.Cells(19, 3) = "Poly"  Else    List1.Cells(19, 2) = ""  End IfEnd Sub'Změna barvy poly v modulechPrivate Sub CheckBox6_Change()  ComboBox5.Visible = CheckBox6.Value  ComboBox6.Visible = CheckBox6.Value  Label10.Visible = CheckBox6.Value  Label11.Visible = CheckBox6.ValueEnd Sub'Změna barvy poly ve velkém čelePrivate Sub CheckBox7_Change()  ComboBox7.Visible = CheckBox7.Value  Label12.Visible = CheckBox7.ValueEnd Sub'Změna barvy poly v malém čelePrivate Sub CheckBox8_Change()  ComboBox8.Visible = CheckBox8.Value  Label13.Visible = CheckBox8.ValueEnd Sub'Pochozí kolejePrivate Sub CheckBox30_Change()  If CheckBox30.Value Then    List1.Cells(46, 2) = "Ano"  Else    List1.Cells(46, 2) = ""  End IfEnd Sub'Obousměrné kolejePrivate Sub CheckBox9_Change()  If CheckBox9.Value Then    List1.Cells(26, 2) = "Ano"  Else    List1.Cells(26, 2) = ""  End IfEnd Sub'Koncový zákazníkPrivate Sub OptionButton10_Change()  Frame7.Visible = OptionButton10.Value  CheckBox28.Visible = OptionButton10.ValueEnd Sub'OdběratelPrivate Sub OptionButton9_Change()  Frame6.Visible = OptionButton9.ValueEnd Sub'Dveře ve velkém čelePrivate Sub OptionButton3_Change()  ComboBox16.Visible = OptionButton3.Value  TextBox9.Visible = OptionButton3.Value  TextBox10.Visible = OptionButton3.Value  Label15.Visible = OptionButton3.Value  Label16.Visible = OptionButton3.Value  CheckBox25.Visible = OptionButton3.ValueEnd Sub'Klapka ve velkém čelePrivate Sub OptionButton4_change()  TextBox11.Visible = OptionButton4.Value  Label17.Visible = OptionButton4.Value  CheckBox25.Visible = OptionButton4.ValueEnd Sub'Dveře v malém čelePrivate Sub OptionButton7_Change()  ComboBox17.Visible = OptionButton7.Value  TextBox13.Visible = OptionButton7.Value  TextBox14.Visible = OptionButton7.Value  Label19.Visible = OptionButton7.Value  Label20.Visible = OptionButton7.Value  CheckBox26.Visible = OptionButton7.ValueEnd Sub'Klapka v malém čelePrivate Sub OptionButton8_change()  TextBox15.Visible = OptionButton8.Value  Label21.Visible = OptionButton8.Value  CheckBox26.Visible = OptionButton8.ValueEnd Sub'Změna šířky zastřešeníPrivate Sub TextBox4_AfterUpdate() Zmena_hodnotEnd Sub'Inicializace formulářePrivate Sub UserForm_Initialize()  TextBox2.Value = CStr(Date)End Sub'Změna standartní výšky a šířkyPublic Sub Zmena_hodnot()  stara_hodnota = TextBox4.Value  If TextBox4.Value = "" Then TextBox4.Value = 3000  If (ComboBox3.Value < 2) Or (ComboBox3.Value = "") Then ComboBox3.Value = 2  If (ComboBox2.Value = "") Then ComboBox2.ListIndex = 0  If (CLng(TextBox4.Value) > 2000) And ((ComboBox2.Value = "PRACTIC" And CLng(TextBox4.Value) <= 5500) Or (ComboBox2.Value = "HARMONY" And CLng(TextBox4.Value) <= 6000) Or (ComboBox2.Value = "DREAM" And CLng(TextBox4.Value) <= 6000) Or (ComboBox2.Value = "HORIZONT" And CLng(TextBox4.Value) <= 6000) Or (ComboBox2.Value = "STAR" And CLng(TextBox4.Value) <= 5500) Or (ComboBox2.Value = "ROCK" And CLng(TextBox4.Value) <= 6000) Or (ComboBox2.Value = "TERRACE" And CLng(TextBox4.Value) <= 5000) Or (ComboBox2.Value = "WAVE" And CLng(TextBox4.Value) <= 5000) Or (ComboBox2.Value = "FLASH" And CLng(TextBox4.Value) <= 5000) Or (ComboBox2.Value = "WING" And CLng(TextBox4.Value) <= 5000) Or (ComboBox2.Value = "SUNSET" And CLng(TextBox4.Value) <= 5500)) Then    sloupec = 2 * (ComboBox3.Value - 2) + 2    zacatek_ceniku = 10 + (20 * ComboBox2.ListIndex + 1 - 1)    'vpořádku    If ComboBox2.Value = "TERRACE" Then      If Round(((CLng(TextBox4.Value) - 1750) / 250), 5) <= Round(((CLng(TextBox4.Value) - 1750) / 250), 0) Then        radek = zacatek_ceniku - 1 + Round(((CLng(TextBox4.Value) - 1750) / 250), 0)      Else        radek = zacatek_ceniku + Round(((CLng(TextBox4.Value) - 1750) / 250), 0)      End If        Else          If (CLng(TextBox4.Value) >= 2000) And (CLng(TextBox4.Value) < 3000) Then        radek = zacatek_ceniku      Else        If Round(((CLng(TextBox4.Value) - 2750) / 250), 5) <= Round(((CLng(TextBox4.Value) - 2750) / 250), 0) Then          radek = zacatek_ceniku - 1 + Round(((CLng(TextBox4.Value) - 2750) / 250), 0)        Else          radek = zacatek_ceniku + Round(((CLng(TextBox4.Value) - 2750) / 250), 0)        End If      End If    End If    If CheckBox1.Value Then      TextBox5.Value = List3.Cells(5, sloupec)      List1.Cells(13, 3) = List3.Cells(5, sloupec)    End If    If CheckBox2.Value Then      TextBox6.Value = Round(List3.Cells(radek, sloupec + 1) * 1000)      List1.Cells(14, 3) = Round(List3.Cells(radek, sloupec + 1) * 1000)    End If    List1.Cells(15, 4) = List3.Cells(radek, sloupec)  Else  vysledek = MsgBox("Mimo rozsah", vbInformation)  TextBox4.Value = stara_hodnota  End IfEnd SubFORMS VBA

'vycisteni nezadanych hodnotPrivate Sub Vymaz_prazdne()  'plný poly v modulech  If Not (CheckBox3.Value) Then    List1.Cells(17, 2).Value = ""  End If  'změna barvy v modulech  If Not (CheckBox6.Value) Then    List1.Cells(20, 2).Value = ""    List1.Cells(20, 3).Value = ""  End If  'změna barvy VČ  If Not (CheckBox7.Value) Then    List1.Cells(21, 2).Value = ""  End If  'změna barvy MČ  If Not (CheckBox8.Value) Then    List1.Cells(22, 2).Value = ""  End If  'pochozí koleje  If Not (CheckBox30.Value) Then    List1.Cells(46, 2).Value = ""  End If  'obousměrné koleje  If Not (CheckBox9.Value) Then    List1.Cells(26, 2).Value = ""  End If  'prodloužení kolejí  If Not (CheckBox10.Value) Then    List1.Cells(27, 2).Value = ""  End If  'VČ dveře  If Not (OptionButton3.Value) Then    List1.Cells(30, 2).Value = ""    List1.Cells(31, 2).Value = ""    List1.Cells(31, 3).Value = ""  End If  'VČ klapka  If Not (OptionButton4.Value) Then    List1.Cells(32, 2).Value = ""  End If  'VČzámek  If Not (CheckBox25.Value) Then    List1.Cells(33, 2).Value = ""  End If    'zámek není pokud je čelo pevné  If (OptionButton1.Value) Then    List1.Cells(33, 2).Value = ""  End If  'MČ dveře  If Not (OptionButton7.Value) Then    List1.Cells(36, 2).Value = ""    List1.Cells(37, 2).Value = ""    List1.Cells(37, 3).Value = ""  End If  'MČ klapka  If Not (OptionButton8.Value) Then    List1.Cells(38, 2).Value = ""  End If  'MČzámek  If Not (CheckBox26.Value) Then    List1.Cells(39, 2).Value = ""  End If  'zámek není pokud je čelo pevné  If (OptionButton5.Value) Then    List1.Cells(39, 2).Value = ""  End If     'BD  If Not (CheckBox12.Value) Then    List1.Cells(40, 2).Value = ""    List1.Cells(41, 2).Value = ""  End If   'BD  If Not (CheckBox13.Value) Then    List1.Cells(41, 2).Value = ""  End If     'Jiny doplnek 1  If Not (CheckBox16.Value) Then    List1.Cells(43, 2).Value = ""    List1.Cells(43, 3).Value = ""  End If   'Jiny doplnek 2  If Not (CheckBox17.Value) Then    List1.Cells(44, 2).Value = ""    List1.Cells(44, 3).Value = ""  End If   'Jiny doplnek 3  If Not (CheckBox18.Value) Then    List1.Cells(45, 2).Value = ""    List1.Cells(45, 3).Value = ""  End IfEnd Sub'Změna typu zastřešeníPrivate Sub ComboBox2_afterupdate()  Zmena_hodnot  If ComboBox2.Value = "PRACTIC" Then  List7.ImageNabidka.Picture = List2.ImagePractic.Picture  CheckBox32.Visible = True  CheckBox33.Visible = False  End If  If ComboBox2.Value = "HARMONY" Then   List7.ImageNabidka.Picture = List2.ImageHarmony.Picture   CheckBox32.Visible = True   CheckBox33.Visible = True  End If  If ComboBox2.Value = "DREAM" Then   List7.ImageNabidka.Picture = List2.ImageDream.Picture   CheckBox32.Visible = True   CheckBox33.Visible = True  End If  If ComboBox2.Value = "HORIZONT" Then    List7.ImageNabidka.Picture = List2.ImageHorizont.Picture    CheckBox32.Visible = True    CheckBox33.Visible = False  End If  If ComboBox2.Value = "STAR" Then   List7.ImageNabidka.Picture = List2.ImageStar.Picture   CheckBox32.Visible = True   CheckBox33.Visible = True  End If  If ComboBox2.Value = "ROCK" Then   List7.ImageNabidka.Picture = List2.ImageRock.Picture   CheckBox32.Visible = True   CheckBox33.Visible = False  End If  If ComboBox2.Value = "TERRACE" Then   List7.ImageNabidka.Picture = List2.ImageTerrace.Picture   CheckBox32.Visible = True   CheckBox33.Visible = True  End If  If ComboBox2.Value = "WAVE" Then   List7.ImageNabidka.Picture = List2.ImageWave.Picture   CheckBox32.Visible = True   CheckBox33.Visible = False  End If   If ComboBox2.Value = "FLASH" Then   List7.ImageNabidka.Picture = List2.ImageFlash.Picture   CheckBox32.Visible = True   CheckBox33.Visible = False  End If   If ComboBox2.Value = "WING" Then   List7.ImageNabidka.Picture = List2.ImageWing.Picture   CheckBox32.Visible = True   CheckBox33.Visible = False  End If     If ComboBox2.Value = "SUNSET" Then    List7.ImageNabidka.Picture = List2.ImageSunset.Picture    CheckBox32.Visible = True    CheckBox33.Visible = False  End IfEnd Sub'Zmena počtu modulůPrivate Sub ComboBox3_AfterUpdate()  Zmena_hodnotEnd Sub'HotovoPrivate Sub CommandButton1_Click()  Module1.Vymaz_nabidku  Vymaz_prazdne  radek = 23  'Změna výšky  If List1.Cells(16, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Zvýšení zastřešení o"    List7.Cells(radek, 4).Value = CStr(CLng(List1.Cells(14, 2).Value) - CLng(List1.Cells(14, 3).Value))    List7.Cells(radek, 5).Value = "mm"    List7.Cells(radek, 6).Value = List1.Cells(16, 4).Value    radek = radek + 1  End If    If List1.Cells(14, 4).Value < 0 Then    List7.Cells(radek, 1).Value = "Snížení zastřešení o"    List7.Cells(radek, 4).Value = CStr((CLng(List1.Cells(14, 2).Value) - CLng(List1.Cells(14, 3).Value)) * -1)    List7.Cells(radek, 5).Value = "mm"    List7.Cells(radek, 6).Value = "ZDARMA"    radek = radek + 1  End If      'Plný poly v modulech If List1.Cells(17, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Plný polykarbonát v "    List7.Cells(radek, 4).Value = (List1.Cells(17, 2).Value)    List7.Cells(radek, 5).Value = "modulech"    List7.Cells(radek, 6).Value = List1.Cells(17, 4).Value    radek = radek + 1  End If  'Plný poly ve VČ  If List1.Cells(18, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Plný polykarbonát ve velkém čele "    List7.Cells(radek, 6).Value = List1.Cells(18, 4).Value    radek = radek + 1  End If  'Plný poly ve MČ  If List1.Cells(19, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Plný polykarbonát v malém čele "    List7.Cells(radek, 6).Value = List1.Cells(19, 4).Value    radek = radek + 1  End If  'plný poly v šikminách  If List1.Cells(29, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Plný polykarbonát v šikminách "    List7.Cells(radek, 6).Value = List1.Cells(29, 4).Value    radek = radek + 1  End If    'Barevný poly v modulech  If List1.Cells(20, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Změna barvy výplně na " + ComboBox5.Value + " v"    List7.Cells(radek, 4).Value = (List1.Cells(20, 3).Value)    List7.Cells(radek, 5).Value = "modulech"    List7.Cells(radek, 6).Value = List1.Cells(20, 4).Value    radek = radek + 1  End If  'Barevný poly ve VČ  If List1.Cells(21, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Změna barvy výplně na " + ComboBox7.Value + " ve velkém čele"    List7.Cells(radek, 6).Value = List1.Cells(21, 4).Value    radek = radek + 1  End If  'Barevný poly ve MČ  If List1.Cells(22, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Změna barvy výplně na " + ComboBox8.Value + " v malém čele"    List7.Cells(radek, 6).Value = List1.Cells(22, 4).Value    radek = radek + 1  End If  'Zpevnění pro podh oblast  If List1.Cells(23, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Zpevnění pro podhorskou oblast"    List7.Cells(radek, 6).Value = List1.Cells(23, 4).Value    radek = radek + 1  End If  'Prodloužení zastřešení  If List1.Cells(24, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Prodloužení " + ComboBox14.Value + " modulů o"    List7.Cells(radek, 4).Value = CStr(CLng(List1.Cells(13, 2).Value) - CLng(List1.Cells(13, 3).Value))    List7.Cells(radek, 5).Value = "mm"    List7.Cells(radek, 6).Value = List1.Cells(24, 4).Value    radek = radek + 1  End If   'Zkrácení zastřešení  If List1.Cells(25, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Zkrácení " + ComboBox14.Value + " modulů o " + CStr(CLng(List1.Cells(13, 4).Value)) + " mm"    List7.Cells(radek, 6).Value = List1.Cells(25, 4).Value    radek = radek + 1  End If  'Pochozí koleje  If List1.Cells(46, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Pochozí koleje"   ' List7.Cells(radek, 6).Value = List1.Cells(46, 4).Value    List7.Cells(radek, 6).Value = "ZDARMA"    radek = radek + 1  End If    'Obousměrné koleje  If List1.Cells(26, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Obousměrné koleje"   ' List7.Cells(radek, 6).Value = List1.Cells(26, 4).Value    List7.Cells(radek, 6).Value = "ZDARMA"    radek = radek + 1  End If  'Prodloužení kolejí If List1.Cells(27, 2).Value > 0 Then    List7.Cells(radek, 1).Value = "Prodloužení kolejí o"    List7.Cells(radek, 4).Value = List1.Cells(27, 2).Value    List7.Cells(radek, 5).Value = "mm"    If List1.Cells(27, 4).Value = 0 Then       List7.Cells(radek, 6).Value = "ZDARMA"    Else      List7.Cells(radek, 6).Value = List1.Cells(27, 4).Value    End If    radek = radek + 1  End If  'Bez velkého čela  If List1.Cells(28, 4).Value < 0 Then    List7.Cells(radek, 1).Value = "Bez velkého čela"    List7.Cells(radek, 6).Value = List1.Cells(28, 4).Value    radek = radek + 1  End If    'VČ dveře  If List1.Cells(30, 4).Value > 0 Then    List7.Cells(radek, 1).Value = ComboBox16.Value + " dveře ve velkém čele š=" + TextBox9.Value + "  v=" + TextBox10.Value + " mm (výška je přibližná)"    List7.Cells(radek, 6).Value = List1.Cells(30, 4).Value    radek = radek + 1  End If  'VČ klapka  If List1.Cells(32, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Větrací klapka ve velkém čele vysoká " + TextBox11.Value + " mm "    List7.Cells(radek, 6).Value = List1.Cells(32, 4).Value    radek = radek + 1  End If  'VČ zámek  If List1.Cells(33, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Uzamykání dveří "    List7.Cells(radek, 6).Value = List1.Cells(33, 4).Value    radek = radek + 1  End If  'Bez malého čela  If List1.Cells(34, 4).Value < 0 Then    List7.Cells(radek, 1).Value = "Bez malého čela"    List7.Cells(radek, 6).Value = List1.Cells(34, 4).Value    radek = radek + 1  End If  'MČ dělené na části  If List1.Cells(35, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Malé čelo dělené na " + TextBox12.Value + " kusy"    List7.Cells(radek, 6).Value = List1.Cells(35, 4).Value    radek = radek + 1  End If  'MČ dveře  If List1.Cells(36, 4).Value > 0 Then    List7.Cells(radek, 1).Value = ComboBox17.Value + " dveře v malém čele š=" + TextBox13.Value + " v=" + TextBox14.Value + " mm (výška je přibližná)"    List7.Cells(radek, 6).Value = List1.Cells(36, 4).Value    radek = radek + 1  End If  'MČ klapka  If List1.Cells(38, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Větrací klapka v malém čele vysoká " + TextBox15.Value + " mm "    List7.Cells(radek, 6).Value = List1.Cells(38, 4).Value    radek = radek + 1  End If  'MČ zámek  If List1.Cells(39, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Uzamykání dveří "    List7.Cells(radek, 6).Value = List1.Cells(39, 4).Value    radek = radek + 1  End If  'BD  If List1.Cells(40, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Dveře pro boční vstup "    List7.Cells(radek, 6).Value = List1.Cells(40, 4).Value    radek = radek + 1  End If  'BD zámek  If List1.Cells(41, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Uzamykání dveří "    List7.Cells(radek, 6).Value = List1.Cells(41, 4).Value    radek = radek + 1  End If  'Uzamykání segmentů  If List1.Cells(42, 4).Value > 0 Then    List7.Cells(radek, 1).Value = "Uzamykání " + CStr(List1.Cells(12, 2).Value - 1) + " segmentů"    List7.Cells(radek, 6).Value = List1.Cells(42, 4).Value    radek = radek + 1  End If    'Změna barvy konstrukce  If List1.Cells(47, 4).Value <> 0 Then    List7.Cells(radek, 1).Value = "Nástřik konstrukce dle RAL - " + CStr(List1.Cells(47, 3).Value)    List7.Cells(radek, 6).Value = List1.Cells(47, 4).Value    radek = radek + 1  End If    'Bronzový elox  If List1.Cells(48, 2).Value = "Bronz" Then    List7.Cells(radek, 1).Value = "Konstrukce v bronzovém eloxu"    List7.Cells(radek, 6).Value = List1.Cells(48, 4).Value    radek = radek + 1  End If    'Antracitový elox  If List1.Cells(48, 2).Value = "Antracit" Then    List7.Cells(radek, 1).Value = "Konstrukce v antracitovém eloxu"    List7.Cells(radek, 6).Value = List1.Cells(48, 4).Value    radek = radek + 1  End If    'Jiný příplatek 1  If List1.Cells(43, 4).Value <> 0 Then    List7.Cells(radek, 1).Value = List1.Cells(43, 2).Value    List7.Cells(radek, 6).Value = List1.Cells(43, 4).Value    radek = radek + 1  End If  'Jiný příplatek 2  If List1.Cells(44, 4).Value <> 0 Then    List7.Cells(radek, 1).Value = List1.Cells(44, 2).Value    List7.Cells(radek, 6).Value = List1.Cells(44, 4).Value    radek = radek + 1  End If  'Jiný příplatek 3  If List1.Cells(45, 4).Value <> 0 Then    List7.Cells(radek, 1).Value = List1.Cells(45, 2).Value    List7.Cells(radek, 6).Value = List1.Cells(45, 4).Value    radek = radek + 1  End If        'Akce na stříbrný elox  If List7.Cells(19, 4).Value = "stříbrný elox" Then    List7.Cells(radek, 1).Value = "Sleva na stříbrný elox"    List7.Cells(radek, 6).Value = List7.Cells(22, 6).Value / 10 * -1    radek = radek + 1  End If      radek = radek + 1     'Cena zastřešení  List7.Cells(radek, 1).Value = "Cena zastřešení"  List7.Cells(radek, 6).Formula = "=SUM(F21:F" + CStr(radek - 1) + ")"  cena_zastreseni = CLng(List7.Cells(radek, 6).Value)  radek_ceny = radek  radek = radek + 2  'Doprava  If CheckBox19.Value Then    If TextBox22.Value = "" Then      radek = radek + 1    ElseIf CLng(TextBox22.Value) > 0 Then      List7.Cells(radek, 1).Value = "Doprava"      List7.Cells(radek, 4).Value = TextBox22.Value      List7.Cells(radek, 5).Value = "km"      cena_dopravy = CLng(CDec((TextBox22.Value) * CDec(TextBox23.Value)))      List7.Cells(radek, 6).Value = CStr(cena_dopravy)      radek_dopravy = radek      radek = radek + 1    ElseIf CLng(TextBox22.Value) = 0 Then        List7.Cells(radek, 1).Value = "Doprava"        List7.Cells(radek, 6).Value = "ZDARMA"        cena_dopravy = 0        radek_dopravy = radek        radek = radek + 1    End If  Else    List7.Cells(radek, 1).Value = "Doprava"    List7.Cells(radek, 6).Value = "VLASTNÍ"    cena_dopravy = 0    radek = radek + 1  End If  'Montáž  If ComboBox13.Value <> "" Then    If ComboBox13.Value = "ZDARMA" Then      List7.Cells(radek, 1).Value = "Montáž"      List7.Cells(radek, 6).Value = ComboBox13.Value      cena_montaze = 0      radek = radek + 1    ElseIf ComboBox13.Value = "Montáž v CZ" Then       List7.Cells(radek, 1).Value = ComboBox13.Value       cena_montaze = CDec(List1.Cells(52, 4).Value)       List7.Cells(radek, 6) = cena_montaze       radek = radek + 1        ElseIf ComboBox13.Value = "Montáž v EU" Then       List7.Cells(radek, 1).Value = ComboBox13.Value        cena_montaze = CDec(List1.Cells(52, 4).Value)       List7.Cells(radek, 6) = cena_montaze       radek = radek + 1        ElseIf ComboBox13.Value = "Vlastní" Then       List7.Cells(radek, 1).Value = "Montáž"       List7.Cells(radek, 6).Value = ComboBox13.Value       cena_montaze = 0       radek = radek + 1    End If  Else    radek = radek + 1  End If  radek = radek + 1    'Celkova cena odběratel     List7.Cells(radek, 1).Value = "Celková cena zastřešení"     celkova_cena_zastreseni = CStr(CLng(cena_zastreseni + cena_montaze + cena_dopravy))     List7.Cells(radek, 6).Value = celkova_cena_zastreseni     List7.Cells(radek, 7).Value = " + DPH"     radek_celk_ceny = radek     radek = radek + 2     If CheckBox20.Value Then       List7.Cells(radek, 1).Value = "Sleva pro Vás"       List7.Cells(radek, 4).Value = TextBox24.Value       List7.Cells(radek, 5).Value = "%"       sleva = CStr(CLng(cena_zastreseni * CDbl(TextBox24.Value) / 100))       List7.Cells(radek, 6).Value = sleva       List7.Cells(radek, 7).Value = " + DPH"       radek = radek + 1       List7.Cells(radek, 1).Value = "Cena pro Vás"       List7.Cells(radek, 6).Value = CStr(CLng(celkova_cena_zastreseni) - CLng(sleva))       List7.Cells(radek, 6).Font.Size = 13       List7.Cells(radek, 6).Font.Underline = xlUnderlineStyleSingle       List7.Cells(radek, 7).Value = " + DPH"       radek = radek + 2     End If     If CheckBox22.Value Then       List7.Cells(radek, 1).Value = TextBox25.Value       List7.Cells(radek, 4).Value = TextBox26.Value       List7.Cells(radek, 5).Value = "%"       sleva = CStr(CLng(cena_zastreseni * CDbl(TextBox26.Value) / 100))       List7.Cells(radek, 6).Value = sleva       List7.Cells(radek, 7).Value = " + DPH"       radek = radek + 1       List7.Cells(radek, 1).Value = "Cena pro Vás"       List7.Cells(radek, 6).Value = CStr(CLng(celkova_cena_zastreseni) - CLng(sleva))       List7.Cells(radek, 6).Font.Size = 15       List7.Cells(radek, 6).Font.Underline = xlUnderlineStyleSingle       List7.Cells(radek, 7).Value = " + DPH"       radek = radek + 3     End If  'platnost nabídky  List7.Cells(radek, 1).Value = "Platnost nabídky " + TextBox3.Value + " měsíce od vypracování."  radek = radek + 2  'vypracoval  List7.Cells(radek, 1).Value = "Vypracoval:  " + TextBox32.Text + "  mob.: " + TextBox29.Text  FormZadani.Hide  List7.Activate    End Sub'Tlačítko konecPrivate Sub CommandButton2_Click()  FormZadani.HideEnd Sub'Vymaze hodnotyPrivate Sub CommandButton3_Click()Vymyz_hodnotyEnd Sub'Standartní šířkaPrivate Sub CheckBox1_Change()  If CheckBox1.Value Then Zmena_hodnot  TextBox5.Enabled = Not (CheckBox1.Value)  Label32.Visible = Not (CheckBox1.Value)  ComboBox14.Visible = Not (CheckBox1.Value)  End Sub'Prodloužení kolejíPrivate Sub CheckBox10_Change()  TextBox7.Visible = CheckBox10.Value    If TextBox7.Value <> "" Then      List1.Cells(27, 2) = CLng(TextBox7.Value)    Else      List1.Cells(27, 2) = 0    End IfEnd Sub'Zpevnění pro podhorskou oblastPrivate Sub CheckBox11_Change()  If CheckBox11.Value Then    List1.Cells(23, 2) = "Ano"  Else    List1.Cells(23, 2) = ""  End IfEnd Sub'BDPrivate Sub CheckBox12_Change()  If CheckBox12.Value Then    List1.Cells(40, 2) = "Ano"  Else    List1.Cells(40, 2) = ""  End IfEnd Sub'Zámek BDPrivate Sub CheckBox13_Change()  If CheckBox13.Value Then    List1.Cells(41, 2) = "Ano"  Else    List1.Cells(41, 2) = ""  End IfEnd Sub'barva konstrukcePrivate Sub CheckBox31_Change()  TextBox30.Visible = CheckBox31.Value    If CheckBox31.Value = True Then      List1.Cells(47, 2) = "Ano"      List1.Cells(47, 3) = TextBox30.Value    Else      List1.Cells(47, 2) = ""      List1.Cells(47, 3) = ""    End IfEnd Sub'Jiný příplatek 1Private Sub CheckBox16_Change()  TextBox16.Visible = CheckBox16.Value  TextBox17.Visible = CheckBox16.Value  Label22.Visible = CheckBox16.ValueEnd Sub'Jiný příplatek 2Private Sub CheckBox17_Change()  TextBox18.Visible = CheckBox17.Value  TextBox19.Visible = CheckBox17.Value  Label23.Visible = CheckBox17.ValueEnd Sub'Jiný příplatek 3Private Sub CheckBox18_Change()  TextBox20.Visible = CheckBox18.Value  TextBox21.Visible = CheckBox18.Value  Label24.Visible = CheckBox18.ValueEnd Sub'DopravaPrivate Sub CheckBox19_Change()  TextBox22.Visible = CheckBox19.Value  TextBox23.Visible = CheckBox19.Value  Label25.Visible = CheckBox19.Value  Label26.Visible = CheckBox19.ValueEnd Sub'Standartní výškaPrivate Sub CheckBox2_Change()TextBox6.Enabled = Not (CheckBox2.Value)If CheckBox2.Value Then Zmena_hodnotEnd Sub'Viditelnos velké čeloPrivate Sub CheckBox14_Change()  Frame3.Visible = CheckBox14.Value  If Not (CheckBox14.Value) Then    List1.Cells(28, 2) = "Ano"  Else    List1.Cells(28, 2) = ""  End IfEnd Sub'Viditelnos malé čeloPrivate Sub CheckBox15_Change()  Frame4.Visible = CheckBox15.Value  If Not (CheckBox15.Value) Then    List1.Cells(34, 2) = "Ano"  Else    List1.Cells(34, 2) = ""  End IfEnd Sub'Odběratel standartní peovizePrivate Sub CheckBox20_Change()  TextBox24.Visible = CheckBox20.Value  Label28.Visible = CheckBox20.ValueEnd Sub'Odběratel zvláštní provizePrivate Sub CheckBox22_Change()  TextBox25.Visible = CheckBox22.Value  TextBox26.Visible = CheckBox22.Value  Label29.Visible = CheckBox22.ValueEnd Sub'Zákazník zvláštní provizePrivate Sub CheckBox24_Change()  TextBox27.Visible = CheckBox24.Value  TextBox28.Visible = CheckBox24.Value  Label30.Visible = CheckBox24.ValueEnd Sub'VČ zámek dveříPrivate Sub CheckBox25_Change()  If CheckBox25.Value Then    List1.Cells(33, 2) = "Ano"  Else    List1.Cells(33, 2) = ""  End IfEnd Sub'MČ zámek dveříPrivate Sub CheckBox26_Change()  If CheckBox26.Value Then    List1.Cells(39, 2) = "Ano"  Else    List1.Cells(39, 2) = ""  End IfEnd Sub'Uzamykání segmentůPrivate Sub CheckBox29_Change()  If CheckBox29.Value Then    List1.Cells(42, 2) = "Ano"  Else    List1.Cells(42, 2) = ""  End IfEnd Sub'Plný poly v modulechPrivate Sub CheckBox3_Change()  ComboBox4.Visible = CheckBox3.Value  Label9.Visible = CheckBox3.Value  If CheckBox3.Value Then    List1.Cells(17, 2) = ComboBox4.Value    List1.Cells(17, 3) = "Poly"  End IfEnd Sub'Bronzový eloxPrivate Sub CheckBox32_Click()If CheckBox32.Value Then    List1.Cells(48, 2) = "Bronz"  Else    List1.Cells(48, 2) = ""  End IfEnd Sub'Plný poly v šikmináchPrivate Sub CheckBox33_Click()  If CheckBox33.Value Then    List1.Cells(29, 2) = "Ano"    List1.Cells(29, 3) = "Poly"  Else    List1.Cells(29, 2) = ""  End IfEnd Sub'Antracitový eloxPrivate Sub CheckBox34_Click()If CheckBox34.Value Then    List1.Cells(48, 2) = "Antracit"  Else    List1.Cells(48, 2) = ""  End IfEnd Sub'Plný poly ve VČPrivate Sub CheckBox4_Change()  If CheckBox4.Value Then    List1.Cells(18, 2) = "Ano"    List1.Cells(18, 3) = "Poly"  Else    List1.Cells(18, 2) = ""  End IfEnd Sub'Plný poly v MČPrivate Sub CheckBox5_Change()  If CheckBox5.Value Then    List1.Cells(19, 2) = "Ano"    List1.Cells(19, 3) = "Poly"  Else    List1.Cells(19, 2) = ""  End IfEnd Sub'Změna barvy poly v modulechPrivate Sub CheckBox6_Change()  ComboBox5.Visible = CheckBox6.Value  ComboBox6.Visible = CheckBox6.Value  Label10.Visible = CheckBox6.Value  Label11.Visible = CheckBox6.ValueEnd Sub'Změna barvy poly ve velkém čelePrivate Sub CheckBox7_Change()  ComboBox7.Visible = CheckBox7.Value  Label12.Visible = CheckBox7.ValueEnd Sub'Změna barvy poly v malém čelePrivate Sub CheckBox8_Change()  ComboBox8.Visible = CheckBox8.Value  Label13.Visible = CheckBox8.ValueEnd Sub'Pochozí kolejePrivate Sub CheckBox30_Change()  If CheckBox30.Value Then    List1.Cells(46, 2) = "Ano"  Else    List1.Cells(46, 2) = ""  End IfEnd Sub'Obousměrné kolejePrivate Sub CheckBox9_Change()  If CheckBox9.Value Then    List1.Cells(26, 2) = "Ano"  Else    List1.Cells(26, 2) = ""  End IfEnd Sub'Koncový zákazníkPrivate Sub OptionButton10_Change()  Frame7.Visible = OptionButton10.Value  CheckBox28.Visible = OptionButton10.ValueEnd Sub'OdběratelPrivate Sub OptionButton9_Change()  Frame6.Visible = OptionButton9.ValueEnd Sub'Dveře ve velkém čelePrivate Sub OptionButton3_Change()  ComboBox16.Visible = OptionButton3.Value  TextBox9.Visible = OptionButton3.Value  TextBox10.Visible = OptionButton3.Value  Label15.Visible = OptionButton3.Value  Label16.Visible = OptionButton3.Value  CheckBox25.Visible = OptionButton3.ValueEnd Sub'Klapka ve velkém čelePrivate Sub OptionButton4_change()  TextBox11.Visible = OptionButton4.Value  Label17.Visible = OptionButton4.Value  CheckBox25.Visible = OptionButton4.ValueEnd Sub'Dveře v malém čelePrivate Sub OptionButton7_Change()  ComboBox17.Visible = OptionButton7.Value  TextBox13.Visible = OptionButton7.Value  TextBox14.Visible = OptionButton7.Value  Label19.Visible = OptionButton7.Value  Label20.Visible = OptionButton7.Value  CheckBox26.Visible = OptionButton7.ValueEnd Sub'Klapka v malém čelePrivate Sub OptionButton8_change()  TextBox15.Visible = OptionButton8.Value  Label21.Visible = OptionButton8.Value  CheckBox26.Visible = OptionButton8.ValueEnd Sub'Změna šířky zastřešeníPrivate Sub TextBox4_AfterUpdate() Zmena_hodnotEnd Sub'Inicializace formulářePrivate Sub UserForm_Initialize()  TextBox2.Value = CStr(Date)End Sub'Změna standartní výšky a šířkyPublic Sub Zmena_hodnot()  stara_hodnota = TextBox4.Value  If TextBox4.Value = "" Then TextBox4.Value = 3000  If (ComboBox3.Value < 2) Or (ComboBox3.Value = "") Then ComboBox3.Value = 2  If (ComboBox2.Value = "") Then ComboBox2.ListIndex = 0  If (CLng(TextBox4.Value) > 2000) And ((ComboBox2.Value = "PRACTIC" And CLng(TextBox4.Value) <= 5500) Or (ComboBox2.Value = "HARMONY" And CLng(TextBox4.Value) <= 6000) Or (ComboBox2.Value = "DREAM" And CLng(TextBox4.Value) <= 6000) Or (ComboBox2.Value = "HORIZONT" And CLng(TextBox4.Value) <= 6000) Or (ComboBox2.Value = "STAR" And CLng(TextBox4.Value) <= 5500) Or (ComboBox2.Value = "ROCK" And CLng(TextBox4.Value) <= 6000) Or (ComboBox2.Value = "TERRACE" And CLng(TextBox4.Value) <= 5000) Or (ComboBox2.Value = "WAVE" And CLng(TextBox4.Value) <= 5000) Or (ComboBox2.Value = "FLASH" And CLng(TextBox4.Value) <= 5000) Or (ComboBox2.Value = "WING" And CLng(TextBox4.Value) <= 5000) Or (ComboBox2.Value = "SUNSET" And CLng(TextBox4.Value) <= 5500)) Then    sloupec = 2 * (ComboBox3.Value - 2) + 2    zacatek_ceniku = 10 + (20 * ComboBox2.ListIndex + 1 - 1)    'vpořádku    If ComboBox2.Value = "TERRACE" Then      If Round(((CLng(TextBox4.Value) - 1750) / 250), 5) <= Round(((CLng(TextBox4.Value) - 1750) / 250), 0) Then        radek = zacatek_ceniku - 1 + Round(((CLng(TextBox4.Value) - 1750) / 250), 0)      Else        radek = zacatek_ceniku + Round(((CLng(TextBox4.Value) - 1750) / 250), 0)      End If        Else          If (CLng(TextBox4.Value) >= 2000) And (CLng(TextBox4.Value) < 3000) Then        radek = zacatek_ceniku      Else        If Round(((CLng(TextBox4.Value) - 2750) / 250), 5) <= Round(((CLng(TextBox4.Value) - 2750) / 250), 0) Then          radek = zacatek_ceniku - 1 + Round(((CLng(TextBox4.Value) - 2750) / 250), 0)        Else          radek = zacatek_ceniku + Round(((CLng(TextBox4.Value) - 2750) / 250), 0)        End If      End If    End If    If CheckBox1.Value Then      TextBox5.Value = List3.Cells(5, sloupec)      List1.Cells(13, 3) = List3.Cells(5, sloupec)    End If    If CheckBox2.Value Then      TextBox6.Value = Round(List3.Cells(radek, sloupec + 1) * 1000)      List1.Cells(14, 3) = Round(List3.Cells(radek, sloupec + 1) * 1000)    End If    List1.Cells(15, 4) = List3.Cells(radek, sloupec)  Else  vysledek = MsgBox("Mimo rozsah", vbInformation)  TextBox4.Value = stara_hodnota  End IfEnd SubModule1 VBA

'vymaž hodnotyPublic Sub Vymyz_hodnoty()  Set pole_k_vymyzani = List1.Range("B5:C48")  For Each bunka In pole_k_vymyzani    bunka.Value = ""  Next bunka    Set pole_k_vymazani = List1.Range("B52:C68")  For Each bunka In pole_k_vymazani    bunka.Value = ""  Next bunka      Vymaz_nabidku    End Sub'vymaz nabidkuPublic Sub Vymaz_nabidku()  Set pole_k_vymyzani = List7.Range("A23:G51")    For Each bunka In pole_k_vymyzani    bunka.Value = ""    bunka.Font.Size = 11    bunka.Font.Underline = xlUnderlineStyleNone  Next bunkaEnd Sub'vymyze linky z listuPrivate Sub VymazOdkazy(Sesit As Workbook)Set polelinku = Sesit.LinkSources(xlLinkTypeExcelLinks)If Not (IsEmpty(polelinku)) Then  For Each linka In polelinku  SesitSNabidkou.BreakLink Name:=linka, Type:=xlLinkTypeExcelLinks  NextEnd IfEnd SubModule Výpočty VBA

Const PI = 3.14159265358979Public Function sinus(uhel As Double) As Double  sinus = Sin(uhel * PI / 180)End FunctionPublic Function kosinus(uhel As Double) As Double  kosinus = Cos(uhel * PI / 180)End FunctionPublic Function tangens(uhel As Double) As Double  tangens = Tan(uhel * PI / 180)End FunctionPublic Function arctangens(cislo As Double) As Double  arctangens = Atn(cislo) * 180 / PIEnd FunctionPublic Function arcsinus(cislo As Double) As Double  arcsinus = Atn(cislo / Sqr(-cislo * cislo + 1)) * 180 / PIEnd FunctionPublic Function arckosinus(cislo As Double) As Double  arckosinus = (Atn(-cislo / Sqr(-cislo * cislo + 1)) + 2 * Atn(1)) * 180 / PIEnd Function'najde nejbližší menší mezeru pro rozteč kolejíPublic Function vyber_mezeru(roztec As Double) As DoubleIf (roztec > 47.85 And roztec < 90.1) Then  i = 90.1  While i > roztec    i = i - 3.25  Wend  vyber_mezeru = iEnd IfEnd Function'diskriminant kvadratické rovnicePublic Function diskriminant(a, b, c As Double) As Double  diskriminant = b * b - (4 * a * c)End Function'vypočte kořeny kvadratické rovnicePublic Function koren_x1(a, b, c As Double) As Double  koren_x1 = (-b + Sqr(b * b - (4 * a * c))) / (2 * a)End FunctionPublic Function koren_x2(a, b, c As Double) As Double  koren_x2 = (-b - Sqr(b * b - (4 * a * c))) / (2 * a)End Function'délka oblouku z rádiusu a úhluPublic Function delka_oblouku_RU(R, u As Double) As Double  delka_oblouku_RU = 2 * PI * R / 360 * uEnd Function'úhel oblouku z rádiusu a šířkyPublic Function uhel_oblouku_RS(R, s As Double) As Double  uhel_oblouku_RS = 2 * arcsinus(s / (2 * R))End Function'šířka oblouku z rádiusu a výškyPublic Function sirka_oblouku_RV(R, v As Double) As Double  sirka_oblouku_RV = 2 * Sqr(R * R - (R - v) * (R - v))End Function'rádius oblouku z šířky a výškyPublic Function radius_oblouku_SV(s, v As Double) As Double  radius_oblouku_SV = ((s * s / 4) + v * v) / (2 * v)End Function'plocha kruhové úsečePublic Function plocha_kruhove_vysece(R, alfa As Double) As Double  plocha_kruhove_vysece = (1 / 2 * R * R * ((PI * alfa / 180) - sinus(alfa)))End Function